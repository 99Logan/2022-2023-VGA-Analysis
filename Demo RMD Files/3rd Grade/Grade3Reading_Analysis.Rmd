---
title: "Grade 3 Reading"
author: "Logan Brady"
date: "2023-02-04"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

#Importing library packages
```{r}
library(arsenal)
library(dplyr)
library(ggplot2)
library(ggpubr)
library(tidyr)
library(tidyverse)
library(data.table)
library(readxl)

```

#Importing 3rd Grade Reading Data files
```{r}
Reading_Winter3 <- read_excel("C:/Users/Logan/OneDrive/Desktop/VGA Analysis/Raw VGA Scores/3rd VGA Analysis 22-23.xlsx", sheet = 1)
Reading_Fall3 <- read_excel("C:/Users/Logan/OneDrive/Desktop/VGA Analysis/Raw VGA Scores/3rd VGA Analysis 22-23.xlsx", sheet = 2)
Reading_Detail3 <- read_excel("C:/Users/Logan/OneDrive/Desktop/VGA Analysis/Raw VGA Scores/3rd VGA Analysis 22-23.xlsx", sheet = 5)

View(Reading_Winter3)
View(Reading_Fall3)
View(Reading_Detail3)
```


#Cleaning the datasets.

#Comparing two datasets using comparedf()
```{r}
summary(comparedf(Reading_Winter3, Reading_Fall3))
```

#How to return column titles
```{r}
head(x = Reading_Fall3)
colnames(x = Reading_Fall3)

head(x = Reading_Winter3)
colnames(x = Reading_Winter3)
```

#Rename data columns
```{r}
colnames(Reading_Winter3)[1] = "Last Name"
colnames(Reading_Winter3)[2] = "First Name"
colnames(Reading_Winter3)[3] = "ID"
colnames(Reading_Winter3)[4] = "Test"
colnames(Reading_Winter3)[5] = "Teacher"
colnames(Reading_Winter3)[6] = "Date"
colnames(Reading_Winter3)[7] = "Vertical Scaled Score"

colnames(Reading_Fall3)[1] = "Last Name"
colnames(Reading_Fall3)[2] = "First Name"
colnames(Reading_Fall3)[3] = "Vertical Scaled Score"

colnames(x = Reading_Winter3)
colnames(x = Reading_Fall3)
```

#Changing Vertical Scaled Score in Reading_Winter3 to double
```{r}
Reading_Winter3$"Vertical Scaled Score" <- as.numeric(Reading_Winter3$"Vertical Scaled Score")
head(Reading_Winter3)
```

#Removing renamed columns and saving them into RW3_df, removing them from the spreadsheet to compare using SETDIFF. Will readd them later
```{r}
RW3_df <- data.frame(Reading_Winter3[ , c("ID", "Test", "Teacher", "Date")])

Reading_Winter3[ , c("ID", "Test", "Teacher", "Date")] <- list(NULL)

head(Reading_Winter3)
View(RW3_df)
```

#Manipulating James Moore's Last name to say "MOORE J." to indicate his absence in the winter.
```{r}
Reading_Fall3[77, 1] <- "MOORE J."
view(Reading_Fall3)
```


#Comparing records, using SETDIFF, it shows what occurs in Fall and what doesnt occur in Winter.
```{r}
setdiff(Reading_Fall3$"Last Name", Reading_Winter3$"Last Name")
```

#Comparing records, using SETDIFF, it shows what occurs in Winter and what doesnt occur in Fall.
```{r}
setdiff(Reading_Winter3$"Last Name", Reading_Fall3$"Last Name")
```

#Re-add removed columns in RW3_df back to Reading_Winter3 before isolating those records again. Trying to include teacher name and other info data.
```{r}
Reading_Winter3 = cbind(Reading_Winter3, RW3_df)
View(Reading_Winter3)
```

#Using Data.Table to isolate multiple records from Reading_Fall3. Saving those records to Unenrolled3 dataframe.
```{r}
NoWinterReading3 <- setDT(Reading_Fall3, key = "Last Name")[J(c("BARROS", "BASIRI", "BAYBROOK",
                                            "DE LA CRUZ", "DHAOUADI", "DINDAR",
                                            "DRONE", "DUNCAN", "GEORGE",
                                            "GRIFFIN", "HAMMAKER", "HOLSTEIN",
                                            "JIMERSON", "MENTZER", "MONTES RAMO", "MOORE J.", 
                                            "MORALES YUM", "MORAN", "PEREIRA SAN",
                                            "PEREZ GONZA", "SWITZER RAY", "WEST",
                                            "WHITEHOUSE", "ZAROW"))]
head(NoWinterReading3)
View(NoWinterReading3)
```

#Using Data.Table to isolate multiple records from Reading_Winter3. Saving those records to NewWinter3 dataframe.
```{r}
NoFallReading3 <- setDT(Reading_Winter3, key = "Last Name")[J(c("ALDARRAJI", "ORDONEZ GAI", "OTEY"))]
head(NoFallReading3)
View(NoFallReading3)
```

#Remove saved records from Winter. Aldarraji(4), Ordonez Gai(70), and Otey(71) need to be removed. They are saved under NewWinter3. RUN ONLY ONCE!
```{r}
Reading_Winter3 <- Reading_Winter3[-c(70, 71, 4),]
```

#Th following list of numbers indicates the records that will be deleted from the fall. It doesn't show deletion in Reading_fall in R, but it does when saved to a CSV file.
```{r}
Reading_Fall3 <- Reading_Fall3[-c(8:10, 27, 30:31, 34:35, 41, 44, 46, 54, 59, 73, 75, 77:79, 89:90, 100, 112, 115, 119),]
```

#Saving Reading_Fall3 and Reading_Winter3 as CSV files.
```{r}
write.csv(Reading_Fall3, "Reading_Fall3.csv")
write.csv(Reading_Winter3, "Reading_Winter3.csv")
```

#Reading_Fall3 needs to be reloaded to verify record count.
```{r}
library(readr)
Reading_Fall3 <- read_csv("Reading_Fall3.csv")
colnames(x = Reading_Fall3)
Reading_Fall3[ , c("...1")] <- list(NULL)
View(Reading_Fall3)
```
#At this point, Reading_Winter3 and Reading_Fall3 should both have 95 records.

#Save each dataframe, data table, and datasheet as CSV files.
```{r}
write.csv(Reading_Fall3, "Reading_Fall3.csv")
write.csv(NoWinterReading3, "NoWinterReading3.csv")

write.csv(Reading_Winter3, "Reading_Winter3.csv")
write.csv(NoFallReading3, "NoFallReading3.csv")
write.csv(RW3_df, "RW3_df.csv")
```

