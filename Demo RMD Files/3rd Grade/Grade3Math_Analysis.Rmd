---
title: "Grade 3 Math"
author: "Logan Brady"
date: "2023-02-04"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

#Importing library packages
```{r}
library(arsenal)
library(dplyr)
library(ggplot2)
library(ggpubr)
library(tidyr)
library(tidyverse)
library(data.table)
library(readxl)

```

#Importing 3rd Grade Math Data files
```{r}

Math_Winter3 <- read_excel("C:/Users/Logan/OneDrive/Desktop/VGA Analysis/Raw VGA Scores/3rd VGA Analysis 22-23.xlsx", sheet = 7)
Math_Fall3 <- read_excel("C:/Users/Logan/OneDrive/Desktop/VGA Analysis/Raw VGA Scores/3rd VGA Analysis 22-23.xlsx", sheet = 8)

View(Math_Winter3)
View(Math_Fall3)
```


#Cleaning the datasets.

#Comparing two datasets using comparedf()
```{r}
summary(comparedf(Math_Winter3, Math_Fall3))
```

#How to return column titles
```{r}
head(x = Math_Fall3)
colnames(x = Math_Fall3)

head(x = Math_Winter3)
colnames(x = Math_Winter3)
```

#Rename data columns
```{r}
colnames(Math_Fall3)[1] = "Last Name"
colnames(Math_Fall3)[2] = "First Name"
colnames(Math_Fall3)[3] = "ID"
colnames(Math_Fall3)[4] = "Test"
colnames(Math_Fall3)[5] = "Teacher"
colnames(Math_Fall3)[6] = "Date"
colnames(Math_Fall3)[7] = "Vertical Scaled Score"

colnames(Math_Winter3)[1] = "Last Name"
colnames(Math_Winter3)[2] = "First Name"
colnames(Math_Winter3)[3] = "Teacher"
colnames(Math_Winter3)[4] = "Vertical Scaled Score"

colnames(x = Math_Fall3)
colnames(x = Math_Winter3)
```

#Removing renamed columns and saving them into RW3_df, removing them from the spreadsheet to compare using SETDIFF. Will readd them later
```{r}
MF3_df <- data.frame(Math_Fall3[ , c("ID", "Test", "Date")])

Math_Fall3[ , c("ID", "Test", "Date")] <- list(NULL)

head(Math_Fall3)
View(MF3_df)
```

#Manipulating James Moore's Last name to say "MOORE J." to indicate his absence in the winter.
```{r}
Math_Fall3[74, 1] <- "MOORE J."
view(Math_Fall3)
```

#Comparing records, using SETDIFF, it shows what occurs in Fall and what doesnt occur in Winter.
```{r}
setdiff(Math_Fall3$"Last Name", Math_Winter3$"Last Name")
```

#Comparing records, using SETDIFF, it shows what occurs in Winter and what doesnt occur in Fall.
```{r}
setdiff(Math_Winter3$"Last Name", Math_Fall3$"Last Name")
```

#Using Data.Table to isolate multiple records from Math_Fall3. Saving those records to NoWinterTest3 data table.
```{r}
NoWinterMath3 <- setDT(Math_Fall3, key = "Last Name")[J(c("ABRAR", "AZAMI", "BARROS", "BASIRI", "CARTAGENA", "COSGROVE", "DINDAR", "DRONE", "DUNCAN", 
                                                          "ESQUIVEL TE", "FAQIRI", "FNU", "HAMMAKER", "HAMMERLE", "HERNANDEZ B", "HERNANDEZ G", "HERTSCH", "IBRAHIMI",
                                                          "JAMOLOVA", "JIMERSON", "KHAN", "KOSIK", "MANZANO - M", "MARROQUIN", "MENTZER", "MONTES RAMO", "MOORE J.", 
                                                          "MOORE", "MORALES YUM", "MORAN", "MURCIA-CALL", "NAWAZY", "NGUYEN", "PACHA", "PENGTHIENG", "PEREIRA SAN",
                                                          "SINGH", "SWITZER RAY", "UMAR", "VARGAS", "WATANDOST", "WEST", "YITBAREK", "ZARAGOZA DI", "ZAROW"))]

head(NoWinterMath3)
View(NoWinterMath3)
```

#Using Data.Table to isolate multiple records from Math_Winter3. Saving those records to NoFallTest3 data table.
```{r}
NoFallMath3 <- setDT(Math_Winter3, key = "Last Name")[J(c("ALDARRAJI", "OTEY"))]
head(NoFallMath3)
View(NoFallMath3)
```

#Remove saved records from Math_Fall. "ABRAR", "AZAMI", "BARROS", "BASIRI", "CARTAGENA", "COSGROVE", "DINDAR", "DRONE", "DUNCAN", "ESQUIVEL TE", "FAQIRI", "FNU", "HAMMAKER", "HAMMERLE", "HERNANDEZ B", "HERNANDEZ G", "HERTSCH", "IBRAHIMI", "JAMOLOVA", "JIMERSON", "KHAN", "KOSIK", "MANZANO - M", "MARROQUIN", "MENTZER", "MONTES RAMO", "MOORE J.", "MOORE", "MORALES YUM", "MORAN", "MURCIA-CALL", "NAWAZY", "NGUYEN", "PACHA", "PENGTHIENG", "PEREIRA SAN", "SINGH", "SWITZER RAY", "UMAR", "VARGAS", "WATANDOST", "WEST", "YITBAREK", "ZARAGOZA DI", "ZAROW"
```{r}
Math_Fall3 <- Math_Fall3[-c(2, 6, 8, 9, 19, 24, 31, 34, 35,
                            36, 37, 39, 46, 47, 50, 51, 52, 56,
                            57, 58, 60, 62, 66, 67, 71, 73, 74,
                            75, 76, 77, 78, 80, 81, 85, 86, 87,
                            94, 98, 102, 104, 107, 110, 115, 116, 117 ),]
View(Math_Fall3)
```

#Remove saved records from Math_Winter3. Removing ALDARRAJI(3) and OTEY(53) from Math_Winter3
```{r}
Math_Winter3 <- Math_Winter3[-c(3, 53),]
View(Math_Winter3)
```

#At this point, Math_Fall3 and Math_Winter3 should both have a total of 72 records. Time for analysis! Consider compiling all incomplete records for verification.

#Saving each dataframe, data table, and data sheet as CSV files.
```{r}
write.csv(Math_Fall3, "Math_Fall3.csv")
write.csv(MF3_df, "MF3_df.csv")
write.csv(NoWinterMath3, "NoWinterMath3.csv")  

write.csv(Math_Winter3, "Math_Winter3.csv")
write.csv(NoFallMath3, "NoFallMath3.csv")
```
